
# SeqOthello
_SeqOthello_ supports fast coverage query and containment query.

## SeqOthello Installation
----
### Requirements
__SeqOthello__ is tested on linux platform with the following system settings. The performance is optimized for Intel CPUs with SSE4.2 support.

  * cmake >= 2.8.4
  * gcc >= 4.9.1
  * libz >= 1.2.3

### Installation

1. Clone the repository:

    ```
    git clone https://github.com/LiuBioinfo/SeqOthello.git
    ```

1. Build SeqOthello:

    ```
    cd SeqOthello/
    ./compile.sh
    ```

    After successfully build the code, you can find __SeqOthello__ toolchain at:

    ``build/bin/``

    ```
    ls build/binary
    ```

## Run SeqOthello

### Build SeqOthello

For demonstration purpose, we added ``createToy.sh`` to create a toy set of experiments and all the necessary scripts to build the __SeqOthello__ structure and perform transcripts query.

1. Create example experiment

    ```
    ./createToy.sh
    tree -d example/
    example
      |-- bin     # folder for binary files
      |-- grp     # folder for group files
      |-- kmer    # toy kmer files
      `-- out     # SeqOthello structure
    ```

    You will find 3 scripts in the ``example/`` folder. We will use them to
    construct __SeqOthello__.

    ```
    ConvertToBinary.sh
    MakeGroup.sh
    BuildSeqOthello.sh
    ```

1. Make __SeqOthello__ binary kmer files

    __SeqOthello__ takes the _k_-mer files generated by [Jellyfish](https://github.com/gmarcais/Jellyfish) as inputs and converts them to binary files. Run ``ConvertToBinary.sh`` to convert
    files in ``kmer/`` to binary and store them in ``bin/``.

    ```
    cd example/
    ./ConvertToBinary.sh
    ls bin/
    ```

2. Make __SeqOthello__  group files

    ***Description***

    ```
    MakeGroup.sh
    ls grp/
    ```

3. Build __SeqOthello__ map

    ***Description***

    ```
    BuildSeqOthello.sh
    ls map/
    ```
```


#### Build SeqOthello in parallel

2 of the steps in __SeqOthello__ construction can be easily paralleled. Foe example, with GNU Parallel, you can convert _k_-mer files with:

```
cat ConvertToBinary.sh | parallel
```

Then, you can make the group files with:

```
cat MakeGroup.sh | parallel
```

### Transcripts Query

Containment Query

```build/bin/Query --map-folder=out/ --transcript=test.fa --output=queryresult --qthread=8 > querylog```

Coverage Query

```build/bin/Query --map-folder=out/ --transcript=test.fa --detail --output=queryresult --qthread=8 > querylog```

##OnlineQuery
Use the following command to start a server on the machine, (e.g., on TCP port 3322). The service will run as a deamon.

```build/bin/Query --map-folder=out/ --start-server-port 3322```

In another terminal, run the Client program.
```build/bin/Client --transcript=kmer/test.fa --coverage --output=result --port=3333```



## License
Please refer to LICENSE.TXT.
----

## Getting help
For questions running __SeqOthello__, please post to [SeqOthello Google Group](https://groups.google.com/forum/#!forum/seqothello)
